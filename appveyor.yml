version: 1.0.{build}

image: Visual Studio 2017

configuration: Debug

platform: x86

before_build:
- start /wait msiexec /i WordpressDriveBoot\external\winfsp-1.7.20172.msi /qn ADDLOCAL=ALL
- cmd: nuget restore
build:
  verbosity: normal

artifacts: 
 - path: WordpressDrive\bin\$(platform)\$(configuration)
   name: WordpressDriveFiles
 - path: WordpressDriveSetup\bin\$(configuration)\WordpressDriveSetup.msi
   name: WordpressDriveSetup
 - path: WordpressDriveBoot\bin\$(configuration)\WordpressDriveSetup.exe
   name: WordpressDriveFull

deploy:
  release: WordpressDrive-v$(APPVEYOR_BUILD_VERSION)
  description: 'Prerelease'
  provider: GitHub
  auth_token:
    secure: ncvhS0NgCx+2Po6E0kS15tbmnKoE93HJse6D0GoOo0rHcNfnR8cLdNMG6rLecUgP # your encrypted token from GitHub
  artifact: WordpressDriveFiles,   WordpressDriveSetup, WordpressDriveFull          # upload all NuGet packages to release assets
  draft: true
  prerelease: false
  on:
    branch: master                 # release from master branch only
    APPVEYOR_REPO_TAG: true        # deploy on tag push only
